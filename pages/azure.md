---
layout: default
title: Deploying to Microsoft Azure
permalink: /azure/
sitemap:
    priority: 0.7
    lastmod: 2018-08-24T00:00:00-00:00
---

# <i class="fa fa-cloud-upload"></i> Deploying to Microsoft Azure

[Microsoft Azure](https://azure.microsoft.com/overview/?WT.mc_id=online-jhipster-judubois) is a great solution to run JHipster applications in the cloud.

[![Microsoft Azure]({{ site.url }}/images/logo/logo-azure.png)](https://azure.microsoft.com/overview/?WT.mc_id=online-jhipster-judubois)

- The easiest way is to use [Azure App Service](https://azure.microsoft.com/services/app-service/?WT.mc_id=online-jhipster-judubois): you will use a JHipster sub-generator
  to deploy a monolithic application which will be managed by Microsoft Azure.
- If you are using Spring Boot microservices, you can use another JHispter sub-generator to deploy your applications to
 [Azure Spring Cloud](https://azure.microsoft.com/services/spring-cloud/?WT.mc_id=online-jhipster-judubois).
- As with any Docker and Kubernetes cloud provider, you can use the JHipster Docker and Kubernetes support to deploy your Docker images to Microsoft Azure.

## Installing the "az CLI"

You can manage your Azure resources using the [Web-based Azure portal](https://portal.azure.com/?WT.mc_id=online-jhipster-judubois) or using the Azure
command-line inteface, also known as the "az CLI".

As with JHipster we always automate everything, installing this "az CLI" is mandatory in order to work with any of the below options.

To install the az CLI on your machine, [follow the "Install the Azure CLI" official documentation](https://docs.microsoft.com/cli/azure/install-azure-cli/?WT.mc_id=online-jhipster-judubois).

## Current limitations

Those limitations can be solved in the future, if you are interested to help do not hesitate to contribute to the project:

- The sub-generators do not automatically configure external services like databases (see next section for supported databases), Elasticsearch, Kafka or Redis. So you will need to create and configure them manually.
- Azure only provides Maven plugins, and as a result the JHipster sub-generators can only work with Maven.

## Supported databases

### SQL databases

Azure provides all types of databases like MySQL/PostgreSQL/Oracle/MS SQL Server. In Azure, they will be secured by default, so if you want to access them from your JHipster application, you will need to open up their firewall.

For example, on MySQL, you will need to go to "Connection security", and select "Allow access to Azure services". You should also click on the "Add client IP" button to automatically add your current IP to the firewall rule:

![MySQL firewall]({{ site.url }}/images/azure_mysql_firewall.png)

__Warning for MySQL users:__
By default, the MySQL connection string generated by JHipster uses the `useSSL=false` flag in the `spring.datasource.url` property (typically in your `src/main/resources/config/application-prod.yml` file). This is because, by default, JHipster uses a local database. On Azure, your database is secured by default, using an SSL certificate, so you will need to put this flag to `true`.

For example:

```yml
spring:
  datasource:
    type: com.zaxxer.hikari.HikariDataSource
    url: jdbc:mysql://jhipster-database.mysql.database.azure.com:3306/test?useUnicode=true&characterEncoding=utf8&useSSL=true&useLegacyDatetimeCode=false&serverTimezone=UTC
    username: jhipster@jhipster-database
    password: XXXXXX
```

### NoSQL databases

You can install a NoSQL database like Cassandra or MongoDB using [the Azure Marketplace](https://azuremarketplace.microsoft.com/en-us/?WT.mc_id=online-jhipster-judubois), or you can use [CosmosDB](https://azure.microsoft.com/services/cosmos-db/?WT.mc_id=online-jhipster-judubois).

CosmosDB is a globally distributed, managed database from Microsoft. It is compatible at the API level with Cassandra and MongoDB, so it can be used with a JHipster application that is generated using those technologies.

## Storing secrets

There are several "secrets" that you should store securely in JHipster, at least your database password (see previous section), and your security tokens (have a look at our [security documentation]({{ site.url }}/security/) for more information).

There are many options in Azure, where you can store this data in a better place than your `application-prod.yml` file, here are the most common ones:

- A Spring Cloud Config server, like the [JHipster Registry]({{ site.url }}/jhipster-registry/) or the configuration server managed by [Azure Spring Cloud](https://azure.microsoft.com/services/spring-cloud/?WT.mc_id=online-jhipster-judubois). This is the best option, as you can tag and rollback configurations, but it needs a dedicated server.
- Environment variables. This is the easiest option, but it's bit annoying to setup and it is the less secure one.
- [Azure Key Vault](https://azure.microsoft.com/services/key-vault/?WT.mc_id=online-jhipster-judubois): this is the most secured option, and it also works with all technologies (not just Java and Spring). There is a dedicated [Azure Spring Boot Starter for Key Vault](https://docs.microsoft.com/en-us/azure/java/spring-framework/spring-boot-starters-for-azure/?WT.mc_id=online-jhipster-judubois) which is our recommended way to configure JHipster with Azure Key Vault.

## Deploying a Spring Boot executable Jar file to Azure App Service

[Azure App Service](https://azure.microsoft.com/fr-fr/services/app-service/?WT.mc_id=online-jhipster-judubois) is a managed plaform-as-a-service: on Azure, if you want to deploy a monolith, this is our recommended option.

There are two ways to deploy a Spring Boot application to Azure App Service:

- Deploy it as a Docker image: this allows you to ship anything inside your Docker image, which can be good for some specific use cases, but for most scenarios this is the most complex and less secured option.
- Deploy it as an executable Jar file: this is the easiest and more secured option, as the OS and the JVM will be supported and automatically updated by Microsoft.

We recommend using an executable Jar file, but if you'd rather use a Docker image, follow the last section of this page, "Deploying to Docker and Kubernetes".

## Deploying Spring Boot microservices to Azure Spring Cloud

## Deploying to Docker and Kubernetes
